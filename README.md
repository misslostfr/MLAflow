"""
项目：利用机器学习自动化数据预处理与细胞聚类分析
功能：
  1. 自动化数据预处理（质控、归一化、对数转换、高变基因筛选）
  2. PCA 降维（自动调优主成分数 n_pcs，利用贝叶斯优化思想及 CMA-ES）
  3. 邻近图构建与 Leiden 聚类（自动调优聚类分辨率）
  4. UMAP 可视化及聚类质量评价（采用 silhouette 分数作为评价指标）
  5. 使用 Optuna（TPE 采样）进行全流程参数调优，并用 CMA-ES 优化 PCA 参数
说明：
  为了提升性能，对预处理部分固定下来，仅对降维、聚类与 UMAP 参数进行调优，
  这样避免重复计算预处理，节省内存与时间。同时限制并行调参数，并在复制数据时采用浅拷贝，
  加上显式的内存清理，必要时可利用 AnnData 的 backed 模式加载大数据集。
依赖：
  pip install scanpy optuna cma umap-learn
